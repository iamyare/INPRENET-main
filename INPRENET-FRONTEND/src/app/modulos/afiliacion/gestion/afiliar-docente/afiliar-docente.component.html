<ng-template #datosGeneralesTemplate>
  <app-datos-generales-temporal
    [formGroup]="steps[0].formGroup"
    (imageCaptured)="handleImageCaptured($event)">
  </app-datos-generales-temporal>
  <app-col-magisteriales #colMagisterialesComponent [formGroup]="steps[0].formGroup"></app-col-magisteriales>
  <app-peps #pepsComponent [parentForm]="steps[0].formGroup"></app-peps>
</ng-template>

<ng-template #referenciasPersonalesTemplate>
  <app-ref-pers #refPersComponent [formGroup]="steps[1].formGroup"></app-ref-pers>
</ng-template>

<ng-template #bancosTemplate>
  <app-bancos #bancosComponent [formGroup]="steps[2].formGroup"></app-bancos>
</ng-template>

<ng-template #centrosTrabajoTemplate>
  <mat-tab-group>
    <mat-tab label="Puestos de Trabajo">
      <app-dat-puesto-trab #datPuestoTrabComponent [formGroup]="steps[3].formGroup"></app-dat-puesto-trab>
    </mat-tab>
    <mat-tab label="Otras Fuentes de Ingreso">
      <app-otras-fuentes-ingreso #otrasFuentesIngresoComponent [formGroup]="steps[3].formGroup"></app-otras-fuentes-ingreso>
    </mat-tab>
  </mat-tab-group>
</ng-template>

<ng-template #beneficiariosTemplate>
  <app-benef #benefComponent [formGroup]="steps[4].formGroup"></app-benef>
</ng-template>

<mat-horizontal-stepper style="background: transparent;" [linear]="true" #stepper>
  <mat-step>
    <ng-template matStepLabel>
      <div class="step-label">
        <ng-container *ngIf="isStepInvalid(steps[0].formGroup); else validLabel1">
          <mat-icon class="error-icon" color="warn">error_outline</mat-icon>
          <div class="error-text">
            <strong>Datos Generales</strong>
          </div>
        </ng-container>
        <ng-template #validLabel1>Datos Generales</ng-template>
      </div>
    </ng-template>
    <ng-container *ngTemplateOutlet="datosGeneralesTemplate"></ng-container>
    <div>
      <button mat-raised-button  color="primary" (click)="markAllAsTouched(steps[0].formGroup); stepper.next()">Siguiente</button>
    </div>
  </mat-step>

  <mat-step>
    <ng-template matStepLabel>
      <div class="step-label">
        <ng-container *ngIf="isStepInvalid(steps[1].formGroup); else validLabel2">
          <mat-icon class="error-icon" color="warn">error_outline</mat-icon>
          <div class="error-text">
            <strong>Referencias Personales</strong>
          </div>
        </ng-container>
        <ng-template #validLabel2>Referencias Personales</ng-template>
      </div>
    </ng-template>
    <ng-container *ngTemplateOutlet="referenciasPersonalesTemplate"></ng-container>
    <div>
      <button  mat-raised-button  color="primary" (click)="stepper.previous()">Anterior</button>
      <button  mat-raised-button  color="primary" (click)="markAllAsTouched(steps[1].formGroup); stepper.next()">Siguiente</button>
    </div>
  </mat-step>

  <mat-step>
    <ng-template matStepLabel>
      <div class="step-label">
        <ng-container *ngIf="isStepInvalid(steps[2].formGroup); else validLabel4">
          <mat-icon class="error-icon" color="warn">error_outline</mat-icon>
          <div class="error-text">
            <strong>Cuentas Bancarias</strong>
          </div>
        </ng-container>
        <ng-template #validLabel4>Cuentas Bancarias</ng-template>
      </div>
    </ng-template>
    <ng-container *ngTemplateOutlet="bancosTemplate"></ng-container>
    <div>
      <button mat-raised-button  color="primary" (click)="stepper.previous()">Anterior</button>
      <button mat-raised-button  color="primary" (click)="markAllAsTouched(steps[2].formGroup); stepper.next()">Siguiente</button>
    </div>
  </mat-step>

  <mat-step>
    <ng-template matStepLabel>
      <div class="step-label">
        <ng-container *ngIf="isStepInvalid(steps[3].formGroup); else validLabel5">
          <mat-icon class="error-icon" color="warn">error_outline</mat-icon>
          <div class="error-text">
            <strong>Centros de Trabajo</strong>
          </div>
        </ng-container>
        <ng-template #validLabel5>Centros de Trabajo</ng-template>
      </div>
    </ng-template>
    <ng-container *ngTemplateOutlet="centrosTrabajoTemplate"></ng-container>
    <div>
      <button mat-raised-button  color="primary" (click)="stepper.previous()">Anterior</button>
      <button mat-raised-button  color="primary" (click)="markAllAsTouched(steps[3].formGroup); stepper.next()">Siguiente</button>
    </div>
  </mat-step>

  <mat-step>
    <ng-template matStepLabel>
      <div class="step-label">
        <ng-container *ngIf="isStepInvalid(steps[4].formGroup); else validLabel6">
          <mat-icon class="error-icon" color="warn">error_outline</mat-icon>
          <div class="error-text">
            <strong>Beneficiarios</strong>
          </div>
        </ng-container>
        <ng-template #validLabel6>Beneficiarios</ng-template>
      </div>
    </ng-template>
    <ng-container *ngTemplateOutlet="beneficiariosTemplate"></ng-container>
    <div>
      <button mat-raised-button  color="primary" (click)="stepper.previous()">Anterior</button>
      <button mat-raised-button  color="primary"  (click)="onSubmit()">Enviar</button>
    </div>
  </mat-step>
</mat-horizontal-stepper>

<!-- <pre *ngIf="formErrors" class="error-display">{{ formErrors | json }}</pre> -->