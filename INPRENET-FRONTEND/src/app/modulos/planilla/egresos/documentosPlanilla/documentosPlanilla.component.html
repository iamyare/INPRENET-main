<div class="center-container">
  <div class="container mat-elevation-z4">
    <h2 class="title">Generar Reportes de Planilla</h2>
    <label style="font-weight: bold; margin-bottom: 20px;"> Seleccione un tipo de planilla y el rango de fecha </label>
    <br>
    <form [formGroup]="planillaForm">
      <div class="button-group">
        <!-- Botones de selección de tipo de planilla -->
        <button mat-raised-button color="primary" [ngClass]="{'selected': tipoPlanilla === '60 RENTAS'}" (click)="seleccionarTipoPlanilla('60 RENTAS')">60 RENTAS</button>
        <button mat-raised-button color="primary" [ngClass]="{'selected': tipoPlanilla === 'ordinaria'}" (click)="seleccionarTipoPlanilla('ordinaria')">ORDINARIA</button>
        <button mat-raised-button color="primary" [ngClass]="{'selected': tipoPlanilla === 'complementaria'}" (click)="seleccionarTipoPlanilla('complementaria')">COMPLEMENTARIA</button>
        <button mat-raised-button color="primary" [ngClass]="{'selected': tipoPlanilla === 'extraordinaria'}" (click)="seleccionarTipoPlanilla('extraordinaria')">EXTRAORDINARIA</button>
      </div>
      <div class="form-fields">
        <!-- Campo de rango de fechas -->
        <mat-form-field appearance="outline" class="field">
          <mat-label>Rango de Fechas</mat-label>
          <mat-date-range-input [rangePicker]="picker" formGroupName="rangoFechas">
            <input matStartDate formControlName="fechaInicio" placeholder="Fecha de inicio">
            <input matEndDate formControlName="fechaFin" placeholder="Fecha de fin">
          </mat-date-range-input>
          <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
          <mat-date-range-picker #picker></mat-date-range-picker>

          <!-- Mensajes de error -->
          <mat-error *ngIf="planillaForm.get('rangoFechas')?.hasError('differentMonths')">
            Las fechas deben pertenecer al mismo mes y año.
          </mat-error>
          <mat-error *ngIf="planillaForm.get('rangoFechas')?.hasError('invalidRange')">
            La fecha de inicio no puede ser posterior a la fecha de fin.
          </mat-error>
        </mat-form-field>
      </div>
      <button class="button" mat-raised-button color="primary" (click)="generarReporteJubiladosYPensionadosActivos()">Generar Reporte de Planilla (Con y Sin Cuenta Bancaria)</button>

      <div class="button-group-reportes" *ngIf="fechaInicioFormateada && fechaFinFormateada">
        <!-- Botones de generación de reportes -->
        <button class="button" mat-raised-button color="primary" [disabled]="!planillaForm.valid " (click)="generarDocumento()">Generar Reporte de Planilla (Con y Sin Cuenta Bancaria)</button>
        <button class="button" mat-raised-button color="primary" [disabled]="!planillaForm.valid " (click)="generarDocumentoSinCuenta()">Generar Reporte (Sin Cuenta)</button>
        <button class="button" mat-raised-button color="primary" [disabled]="!planillaForm.valid " (click)="generarPDFMontosPorBancoPeriodo()">Generar Reporte de Montos por Banco</button>
        <button class="button" mat-raised-button color="primary" [disabled]="!planillaForm.valid" (click)="generarReporteTotalesDeducciones()">
          Generar Reporte de Totales de Deducciones por institución
        </button>
        <button class="button" mat-raised-button color="accent" [disabled]="!planillaForm.valid " (click)="descargarReporte()">Descargar Archivo De Pago (Con cuenta Bancaria)</button>
        <button class="button" mat-raised-button color="accent" [disabled]="!planillaForm.valid " (click)="descargarReporteBSC()">Descargar Desglose de planilla (sin cuenta bancaria)</button>
        <!-- <button mat-raised-button color="primary" [disabled]="!planillaForm.valid" (click)="generarReporteTotalesDeduccionesSinCuentBanc()">
          Generar Reporte de Totales de Deducciones Sin Cuenta Banco
        </button> -->
        <button class="button" mat-raised-button color="accent" [disabled]="!planillaForm.valid" (click)="generarReportePartidaDiario()">
          Generar Reporte de Partida de Diario
        </button>

        <button class="button" mat-raised-button color="primary" [disabled]="!planillaForm.valid" (click)="openDynamicDialog([{ name: 'codDeduccion', label: 'Código de Deducción', type: 'number' }])">
          Descargar excel de deducciones por código de deducción
        </button>

        <button class="button" mat-raised-button color="primary" [disabled]="!planillaForm.valid" (click)="exportarExcelDetallePorPeriodo()">
          Exportar Detalle a Excel
        </button>

        <button class="button" mat-raised-button color="primary" [disabled]="!planillaForm.valid" (click)="descargarExcelInv()">Generar Excel Para Inversiones</button>
        <!-- Puedes añadir más botones aquí -->
      </div>
    </form>
  </div>
</div>
