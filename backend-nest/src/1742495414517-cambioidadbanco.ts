import { MigrationInterface, QueryRunner } from "typeorm";

export class Cambioidadbanco1742495414517 implements MigrationInterface {
    name = 'Cambioidadbanco1742495414517'

    public async up(queryRunner: QueryRunner): Promise<void> {
        /* await queryRunner.query(`ALTER TABLE "NET_DETALLE_PAGO_BENEFICIO" DROP CONSTRAINT "FK_ID_AF_BANCO_DETPAGBEN"`);
        await queryRunner.query(`ALTER TABLE "NET_DETALLE_DEDUCCION" DROP CONSTRAINT "FK_ID_AF_BANCO_DETDED"`); */

        await queryRunner.query(`CREATE TABLE "NET_BANCO_PLANILLA" ("ID_BANCO_PLANILLA" number GENERATED BY DEFAULT AS IDENTITY, "ID_PERSONA" number NOT NULL, "ID_DETALLE_PERSONA" number NOT NULL, "ID_CAUSANTE" number NOT NULL, "ID_BENEFICIO" number NOT NULL, "ID_PLANILLA" number NOT NULL, "ID_AF_BANCO" number, CONSTRAINT "PK_ID_BANCO_PLANILLA" PRIMARY KEY ("ID_BANCO_PLANILLA"))`);

        /* await queryRunner.query(`ALTER TABLE "NET_DETALLE_PAGO_BENEFICIO" DROP COLUMN "ID_AF_BANCO"`);
        await queryRunner.query(`ALTER TABLE "NET_DETALLE_DEDUCCION" DROP COLUMN "ID_AF_BANCO"`); */

        await queryRunner.query(`ALTER TABLE "NET_DETALLE_PAGO_BENEFICIO" DROP CONSTRAINT "PK_BENPLAN_DETPLANB"`);

        await queryRunner.query(`ALTER TABLE "NET_DETALLE_PAGO_BENEFICIO" ADD CONSTRAINT "PK_BENPLAN_DETPLANB" PRIMARY KEY ("ID_PERSONA", "ID_DETALLE_PERSONA", "ID_CAUSANTE", "ID_BENEFICIO", "ID_PLANILLA")`);
        await queryRunner.query(`ALTER TABLE "NET_DETALLE_PAGO_BENEFICIO" DROP CONSTRAINT "FK_ID_BEN_PLAN_AFIL_DETPAGBEN"`);

        await queryRunner.query(`ALTER TABLE "NET_DETALLE_PAGO_BENEFICIO" DROP CONSTRAINT "FK_ID_PLANILLA_DETPAGBEN"`);
        await queryRunner.query(`ALTER TABLE "NET_DETALLE_PAGO_BENEFICIO" DROP CONSTRAINT "PK_BENPLAN_DETPLANB"`);

        await queryRunner.query(`ALTER TABLE "NET_DETALLE_PAGO_BENEFICIO" ADD CONSTRAINT "PK_9bcf44c5fea5a00852f9549721c" PRIMARY KEY ("ID_PLANILLA", "ID_BENEFICIO", "ID_DETALLE_PERSONA", "ID_CAUSANTE", "ID_PERSONA")`);
        await queryRunner.query(`ALTER TABLE "NET_DETALLE_PAGO_BENEFICIO" DROP COLUMN "ID_BENEFICIO_PLANILLA"`);

        await queryRunner.query(`ALTER TABLE "NET_DETALLE_PAGO_BENEFICIO" ADD "ID_BENEFICIO_PLANILLA" number NOT NULL`);
        await queryRunner.query(`ALTER TABLE "NET_DETALLE_PAGO_BENEFICIO" MODIFY "ID_PERSONA" number  NOT NULL`);

        await queryRunner.query(`ALTER TABLE "NET_DETALLE_PAGO_BENEFICIO" MODIFY "ID_DETALLE_PERSONA" number  NOT NULL`);
        await queryRunner.query(`ALTER TABLE "NET_DETALLE_PAGO_BENEFICIO" MODIFY "ID_CAUSANTE" number  NOT NULL`);

        await queryRunner.query(`ALTER TABLE "NET_DETALLE_PAGO_BENEFICIO" MODIFY "ID_BENEFICIO" number  NOT NULL`);
        await queryRunner.query(`ALTER TABLE "NET_DETALLE_PAGO_BENEFICIO" MODIFY "ID_PLANILLA" number  NOT NULL`);

        await queryRunner.query(`ALTER TABLE "NET_BANCO_PLANILLA" ADD CONSTRAINT "FK_ID_AF_BANCO_PER_BANCO" FOREIGN KEY ("ID_AF_BANCO") REFERENCES "NET_PERSONA_POR_BANCO" ("ID_AF_BANCO")`);
        await queryRunner.query(`ALTER TABLE "NET_BANCO_PLANILLA" ADD CONSTRAINT "FK_ID_PLANILLA_BAN_PLAN" FOREIGN KEY ("ID_PLANILLA", "ID_BENEFICIO", "ID_CAUSANTE", "ID_DETALLE_PERSONA", "ID_PERSONA") REFERENCES "NET_DETALLE_PAGO_BENEFICIO" ("ID_PLANILLA","ID_BENEFICIO","ID_CAUSANTE","ID_DETALLE_PERSONA","ID_PERSONA")`);

        await queryRunner.query(`ALTER TABLE "NET_DETALLE_PAGO_BENEFICIO" ADD CONSTRAINT "FK_ID_PLANILLA_DETPAGBEN" FOREIGN KEY ("ID_PLANILLA") REFERENCES "NET_PLANILLA" ("ID_PLANILLA")`);
        await queryRunner.query(`ALTER TABLE "NET_DETALLE_PAGO_BENEFICIO" ADD CONSTRAINT "FK_ID_BEN_PLAN_AFIL_DETPAGBEN" FOREIGN KEY ("ID_BENEFICIO", "ID_DETALLE_PERSONA", "ID_CAUSANTE", "ID_PERSONA") REFERENCES "NET_DETALLE_BENEFICIO_AFILIADO" ("ID_BENEFICIO","ID_DETALLE_PERSONA","ID_CAUSANTE","ID_PERSONA")`);
    }

    public async down(queryRunner: QueryRunner): Promise<void> {
        await queryRunner.query(`ALTER TABLE "NET_DETALLE_PAGO_BENEFICIO" DROP CONSTRAINT "FK_ID_BEN_PLAN_AFIL_DETPAGBEN"`);
        await queryRunner.query(`ALTER TABLE "NET_DETALLE_PAGO_BENEFICIO" DROP CONSTRAINT "FK_ID_PLANILLA_DETPAGBEN"`);

        await queryRunner.query(`ALTER TABLE "NET_BANCO_PLANILLA" DROP CONSTRAINT "FK_ID_PLANILLA_BAN_PLAN"`);
        await queryRunner.query(`ALTER TABLE "NET_BANCO_PLANILLA" DROP CONSTRAINT "FK_ID_AF_BANCO_PER_BANCO"`);

        await queryRunner.query(`ALTER TABLE "NET_DETALLE_PAGO_BENEFICIO" MODIFY "ID_PLANILLA" number  NULL`);
        await queryRunner.query(`ALTER TABLE "NET_DETALLE_PAGO_BENEFICIO" MODIFY "ID_BENEFICIO" number  NULL`);

        await queryRunner.query(`ALTER TABLE "NET_DETALLE_PAGO_BENEFICIO" MODIFY "ID_CAUSANTE" number  NULL`);
        await queryRunner.query(`ALTER TABLE "NET_DETALLE_PAGO_BENEFICIO" MODIFY "ID_DETALLE_PERSONA" number  NULL`);

        await queryRunner.query(`ALTER TABLE "NET_DETALLE_PAGO_BENEFICIO" MODIFY "ID_PERSONA" number  NULL`);
        await queryRunner.query(`ALTER TABLE "NET_DETALLE_PAGO_BENEFICIO" DROP COLUMN "ID_BENEFICIO_PLANILLA"`);

        await queryRunner.query(`ALTER TABLE "NET_DETALLE_PAGO_BENEFICIO" ADD "ID_BENEFICIO_PLANILLA" number GENERATED BY DEFAULT AS IDENTITY`);
        await queryRunner.query(`ALTER TABLE "NET_DETALLE_PAGO_BENEFICIO" DROP CONSTRAINT "PK_9bcf44c5fea5a00852f9549721c"`);

        await queryRunner.query(`ALTER TABLE "NET_DETALLE_PAGO_BENEFICIO" ADD CONSTRAINT "PK_BENPLAN_DETPLANB" PRIMARY KEY ("ID_BENEFICIO_PLANILLA", "ID_PLANILLA", "ID_BENEFICIO", "ID_DETALLE_PERSONA", "ID_CAUSANTE", "ID_PERSONA")`);
        await queryRunner.query(`ALTER TABLE "NET_DETALLE_PAGO_BENEFICIO" ADD CONSTRAINT "FK_ID_PLANILLA_DETPAGBEN" FOREIGN KEY ("ID_PLANILLA") REFERENCES "NET_PLANILLA" ("ID_PLANILLA")`);

        await queryRunner.query(`ALTER TABLE "NET_DETALLE_PAGO_BENEFICIO" ADD CONSTRAINT "FK_ID_BEN_PLAN_AFIL_DETPAGBEN" FOREIGN KEY ("ID_DETALLE_PERSONA", "ID_PERSONA", "ID_CAUSANTE", "ID_BENEFICIO") REFERENCES "NET_DETALLE_BENEFICIO_AFILIADO" ("ID_DETALLE_PERSONA","ID_PERSONA","ID_CAUSANTE","ID_BENEFICIO")`);
        await queryRunner.query(`ALTER TABLE "NET_DETALLE_PAGO_BENEFICIO" DROP CONSTRAINT "PK_BENPLAN_DETPLANB"`);

        await queryRunner.query(`ALTER TABLE "NET_DETALLE_PAGO_BENEFICIO" ADD CONSTRAINT "PK_BENPLAN_DETPLANB" PRIMARY KEY ("ID_BENEFICIO_PLANILLA")`);
        /* await queryRunner.query(`ALTER TABLE "NET_DETALLE_DEDUCCION" ADD "ID_AF_BANCO" number`); 
        await queryRunner.query(`ALTER TABLE "NET_DETALLE_PAGO_BENEFICIO" ADD "ID_AF_BANCO" number`); */
        await queryRunner.query(`DROP TABLE "NET_BANCO_PLANILLA"`);

        /* await queryRunner.query(`ALTER TABLE "NET_DETALLE_DEDUCCION" ADD CONSTRAINT "FK_ID_AF_BANCO_DETDED" FOREIGN KEY ("ID_AF_BANCO") REFERENCES "NET_PERSONA_POR_BANCO" ("ID_AF_BANCO")`);
        await queryRunner.query(`ALTER TABLE "NET_DETALLE_PAGO_BENEFICIO" ADD CONSTRAINT "FK_ID_AF_BANCO_DETPAGBEN" FOREIGN KEY ("ID_AF_BANCO") REFERENCES "NET_PERSONA_POR_BANCO" ("ID_AF_BANCO")`); */
    }

}
