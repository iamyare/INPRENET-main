<!-- BUSCADOR -->
<div style="text-align: right; ">
  <div class="search-container">
    <mat-form-field appearance="outline" style="background-color: white;">
      <mat-label>Buscar</mat-label>
      <input matInput type="search" [formControl]="formsearch" >
      <button mat-icon-button matSuffix aria-label="Buscar">
        <mat-icon>search</mat-icon>
      </button>
    </mat-form-field>
  </div>
</div>

<!-- DATOS -->
<div style="overflow-x: auto;">
<table class="custom-table">
  <thead>
    <tr class="text-center">
      <th class="custom-header" *ngIf="verOpcEditar"></th>
      <th *ngFor="let col of columns" class="custom-header">{{ col.header }}</th>
      <th class="custom-header">Acciones</th>
    </tr>
  </thead>
  <tbody>
    <tr *ngFor="let row of searchResults && searchResults.slice(desde, hasta); let i = index" class="custom-row">
      <td *ngIf="verOpcEditar"><input type="checkbox" [(ngModel)]="row.isSelected" (change)="onSelectionChange(row)" /></td>
      <td *ngFor="let col of columns" class="custom-cell">
        <ng-container *ngIf="!row.isEditing">
          {{ getCellValue(row, col) }}
        </ng-container>
        <ng-container *ngIf="row.isEditing">
          <ng-container *ngIf="col.isEditable">
            <mat-form-field class="example-full-width; inputs" style="background-color: white;" appearance="outline">
              <input matInput [formControl]="row[col.col + '_control']" />
          </mat-form-field>
            <div *ngIf="row[col.col + '_control'].invalid && row[col.col + '_control'].touched">
              <span *ngFor="let error of getControlErrors(row, col)">
                {{ error }}
              </span>
            </div>
          </ng-container>
          <ng-container *ngIf="!col.isEditable">
            {{ getCellValue(row, col) }}
          </ng-container>
        </ng-container>
      </td>
      <td>
        <button mat-raised-button *ngIf="!row.isEditing" (click)="startEditing(row)" style="background-color: #628780; color: #ffffff; border-radius: 5px; padding: 10px 20px;">Editar</button>
        <button mat-raised-button *ngIf="row.isEditing" (click)="saveChanges(row)" style="background-color: #628780; color: #ffffff; border-radius: 5px; padding: 10px 20px;">Guardar</button>
        <button mat-raised-button *ngIf="row.isEditing" (click)="stopEditing(row)" style="background-color: #628780; color: #ffffff; border-radius: 5px; padding: 10px 20px;">Cancelar</button>
      </td>
    </tr>
  </tbody>
</table>
</div>

<mat-paginator [length]="filas?.length" [pageSize]="itemsPerPage" [pageSizeOptions]="[itemsPerPage]" (page)="onPageChange($event)"></mat-paginator>
